var $url="/settings/configsHomeMenu",data=utils.init({userMenus:null,groups:null,expandRowKeys:[],userMenu:null,defaultOpeneds:[],defaultActive:null}),methods={btnSideMenuOpen:function(t){var n=_.find(this.userMenus,function(n){return n.id==t});this.userMenu=_.assign({},n),this.defaultActive=t},btnSideMenuClick:function(t){for(var n=(t+"").split("/"),e=this.userMenus,i=null,u=[],s=0;s<n.length;s++)e=(i=_.find(e,function(t){return t.id==n[s]})).children,u.push(i.id);this.defaultOpeneds=u,i&&this.btnMenuClick(i)},btnMenuClick:function(t){this.defaultActive=this.defaultOpeneds.join("/"),this.userMenu=_.assign({},t)},getIndex:function(t,n,e){return e?t.id+"/"+n.id+"/"+e.id:n?t.id+"/"+n.id:t?t.id:""},apiGet:function(){var t=this;utils.loading(this,!0),$api.get($url).then(function(n){var e=n.data;t.userMenus=t.getItems(e.userMenus),t.groups=e.groups}).catch(function(t){utils.error(t)}).then(function(){utils.loading(t,!1)})},apiDelete:function(t){var n=this;utils.loading(this,!0),$api.delete($url,{data:{id:t}}).then(function(t){var e=t.data;n.userMenus=n.getItems(e.userMenus),n.userMenu=null}).catch(function(t){utils.error(t)}).then(function(){utils.loading(n,!1)})},apiReset:function(){var t=this;utils.loading(this,!0),$api.post($url+"/actions/reset").then(function(n){var e=n.data;t.userMenus=t.getItems(e.userMenus),t.userMenu=null}).catch(function(t){utils.error(t)}).then(function(){utils.loading(t,!1)})},apiSubmit:function(t){var n=this;utils.loading(this,!0),$api.post($url,t).then(function(e){var i=e.data;n.userMenu=null,n.userMenus=n.getItems(i.userMenus),utils.success(0===t.id?"用户菜单新增成功！":"用户菜单修改成功！")}).catch(function(t){utils.error(t)}).then(function(){utils.loading(n,!1)})},getItems:function(t){for(var n=[],e=0;e<t.length;e++){0===(i=t[e]).parentId&&(i.children=[],n.push(i))}for(e=0;e<t.length;e++){var i;if((i=t[e]).parentId>0){var u=_.find(n,function(t){return t.id===i.parentId});u&&u.children.push(i)}}return n},getCardTitle:function(){return 0!==this.userMenu.id?"修改菜单":this.userMenu.parentId>0?"新增下级菜单":"新增一级菜单"},btnAddChildClick:function(){var t=this.userMenu?this.userMenu.id:0,n=0,e=null;t>0&&(e=this.userMenus.find(function(n){return n.id===t})),e?_.forEach(e.children,function(t){t.taxis>n&&(n=t.taxis)}):0===t&&_.forEach(this.userMenus,function(t){t.taxis>n&&(n=t.taxis)}),this.userMenu={id:0,disabled:!1,parentId:t,taxis:n+1,text:"",link:"",iconClass:"",target:"",isGroup:!1,groupIds:[]},this.defaultActive=null},btnAddFirstClick:function(){var t=0;_.forEach(this.userMenus,function(n){n.taxis>t&&(t=n.taxis)}),this.userMenu={id:0,disabled:!1,parentId:0,taxis:t+1,text:"",link:"",iconClass:"",target:"",isGroup:!1,groupIds:[]},this.defaultActive=null},btnResetClick:function(){var t=this;utils.alertDelete({title:"重置用户菜单",text:"此操作将把用户菜单恢复为系统默认值，确定吗？",button:"确认重置",callback:function(){t.apiReset()}})},btnDeleteClick:function(){var t=this;utils.alertDelete({title:"删除用户菜单",text:"此操作将删除用户菜单及其下级菜单，确定吗？",callback:function(){t.apiDelete(t.userMenu.id)}})},btnSubmitClick:function(){var t=this;this.$refs.userMenu.validate(function(n){n&&t.apiSubmit(t.userMenu)})},btnCancelClick:function(){this.userMenu=null}},$vue=new Vue({el:"#main",data:data,methods:methods,created:function(){this.apiGet()}});